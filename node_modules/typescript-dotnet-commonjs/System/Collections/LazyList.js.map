{"version":3,"sources":["System/Collections/LazyList.ts"],"names":[],"mappings":"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","file":"LazyList.js","sourcesContent":["/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Origin: http://www.fallingcanbedeadly.com/\r\n * Licensing: MIT\r\n */\r\n\r\nimport {IEnumerator} from \"./Enumeration/IEnumerator\";\r\nimport {ReadOnlyCollectionBase} from \"./ReadOnlyCollectionBase\";\r\nimport {IEnumerable} from \"./Enumeration/IEnumerable\";\r\nimport {Action} from \"../FunctionTypes\";\r\nimport {IReadOnlyList} from \"./IList\";\r\nimport {ArgumentOutOfRangeException} from \"../Exceptions/ArgumentOutOfRangeException\";\r\nimport {EnumeratorBase} from \"./Enumeration/EnumeratorBase\";\r\nimport __extendsImport from \"../../extends\";\r\nimport {Integer} from \"../Integer\";\r\n// noinspection JSUnusedLocalSymbols\r\nconst __extends = __extendsImport;\r\n\r\nexport class LazyList<T> extends ReadOnlyCollectionBase<T> implements IReadOnlyList<T>\r\n{\r\n\r\n\tprivate _enumerator:IEnumerator<T>|null;\r\n\tprivate _cached:T[]|null;\r\n\r\n\tconstructor(source:IEnumerable<T>)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._enumerator = source.getEnumerator();\r\n\t\tthis._cached = [];\r\n\t}\r\n\r\n\tprotected _onDispose():void\r\n\t{\r\n\t\tsuper._onDispose();\r\n\t\tconst e = this._enumerator;\r\n\t\tthis._enumerator = null;\r\n\t\tif(e) e.dispose();\r\n\r\n\t\tconst c = this._cached;\r\n\t\tthis._cached = null;\r\n\t\tif(c) c.length = 0;\r\n\t}\r\n\r\n\tprotected _getCount():number\r\n\t{\r\n\t\tthis.finish();\r\n\t\tconst c = this._cached;\r\n\t\treturn c ? c.length : 0;\r\n\t}\r\n\r\n\tprotected _getEnumerator():IEnumerator<T>\r\n\t{\r\n\t\tlet current:number;\r\n\t\treturn new EnumeratorBase<T>(\r\n\t\t\t()=>{\r\n\t\t\t\tcurrent = 0;\r\n\t\t\t},\r\n\t\t\tyielder =>\r\n\t\t\t{\r\n\t\t\t\tthis.throwIfDisposed();\r\n\t\t\t\tconst c = this._cached!;\r\n\t\t\t\treturn (current<c.length || this.getNext())\r\n\t\t\t\t\t? yielder.yieldReturn(c[current++])\r\n\t\t\t\t\t: yielder.yieldBreak();\r\n\t\t\t});\r\n\t}\r\n\r\n\tget(index:number):T\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tInteger.assertZeroOrGreater(index);\r\n\r\n\t\tconst c = this._cached!;\r\n\t\twhile(c.length<=index && this.getNext())\r\n\t\t{}\r\n\r\n\t\tif(index<c.length)\r\n\t\t\treturn c[index];\r\n\r\n\t\tthrow new ArgumentOutOfRangeException(\"index\", \"Greater than total count.\");\r\n\t}\r\n\r\n\tindexOf(item:T):number\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tconst c = this._cached!;\r\n\t\tlet result = c.indexOf(item);\r\n\t\twhile(result== -1 && this.getNext(value =>\r\n\t\t{\r\n\t\t\tif(value==item)\r\n\t\t\t\tresult = c.length - 1;\r\n\t\t}))\r\n\t\t{}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tcontains(item:T):boolean\r\n\t{\r\n\t\treturn this.indexOf(item)!=-1;\r\n\t}\r\n\r\n\tprivate getNext(out?:Action<T>):boolean\r\n\t{\r\n\t\tconst e = this._enumerator;\r\n\t\tif(!e) return false;\r\n\t\tif(e.moveNext())\r\n\t\t{\r\n\t\t\tconst value = e.current!;\r\n\t\t\tthis._cached!.push(value);\r\n\t\t\tif(out) out(value);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\te.dispose();\r\n\t\t\tthis._enumerator = <any>null;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\r\n\tprivate finish():void\r\n\t{\r\n\t\twhile(this.getNext())\r\n\t\t{}\r\n\t}\r\n\r\n\r\n}"]}